---
title: 双网卡问题
date:  2022-08-26
author: chenkun
keys:
---

## 1.1 kde桌面双网卡内外网设置

环境如下：

```shell
$ screenfetch   

 ██████████████████  ████████     chenkun@chenkun-pc
 ██████████████████  ████████     OS: Manjaro 21.3.7 Ruah
 ██████████████████  ████████     Kernel: x86_64 Linux 5.15.60-1-MANJARO
 ██████████████████  ████████     Uptime: 6h 14m
 ████████                   ████████     Packages: 1341
 ████████  ████████  ████████     Shell: zsh 5.9
 ████████  ████████  ████████     Resolution: 3840x1080
 ████████  ████████  ████████     DE: KDE 5.96.0 / Plasma 5.24.6
 ████████  ████████  ████████     WM: KWin
 ████████  ████████  ████████     GTK Theme: WhiteSur-Light [GTK2/3]
 ████████  ████████  ████████     Icon Theme: McMojave-circle
 ████████  ████████  ████████     Disk: 121G / 941G (14%)
 ████████  ████████  ████████     CPU: 12th Gen Intel Core i5-12600K @ 16x 4.9GHz [29.0°C]
 ████████  ████████  ████████     GPU: Mesa Intel(R) Graphics (ADL-S GT1)
                                                   RAM: 16498MiB / 23813MiB
```

### 1.1 内网设置

![image-20220826145228508](https://afatpig.oss-cn-chengdu.aliyuncs.com/blog/image-20220826145228508.png)  
以下代表ip以192.168开头或者以10.10开头统一走192.168.93.1内网网关
![image-20220826145325906](https://afatpig.oss-cn-chengdu.aliyuncs.com/blog/image-20220826145325906.png)

### 1.2 外网（无线）设置（保留默认即可）

![image-20220826145534202](https://afatpig.oss-cn-chengdu.aliyuncs.com/blog/image-20220826145534202.png)

## 2、双网卡DNS解析

::: info 说明

之前一直不清楚双网卡下dns是如何解析的，虽然乱配一通也能用但是一直不知道原因，这次搞明白了顺便总结一下。

:::

在kde配置界面配置的dns地址，实际上是操作的`/etc/resolv.conf`这个文件，文件内容如下：

```shell
$ cat /etc/resolv.conf 
# Generated by NetworkManager
search sonoscape.com
nameserver 10.10.102.8
nameserver 192.168.222.1
nameserver fe80::aa5a:e0ff:fe3d:6d1b%wlp5s0
```

当有多个dns解析服务时，会自上而下依次调用，当第一个解析失败会继续从第二个dns解析。以上配置10.10.102.8是我公司内网dns，192.168.222.1这个是外网网关。
举例说明：

1. 解析rdm.sonoscape.com时，会先从10.10.102.8解析，这个域名是我司内网服务，肯定能解析到；

2. 解析huaweicloud.com这个是在我们内网能够的10.10.102.8是没有的，会走到192.168.222.1解析；

::: info 总结

如果有这种场景，只需要在`/etc/resolv.conf`把内网dns设置在第一行，外网dns放置在后面，优先走内网解析

:::

### 3、搜索域

搜索域用作域搜索列表的一部分域。解析程序使用域搜索列表以及本地域名。当dns查询不到你所输入的域名时，会将dns搜索域拼接在你所查询的域名后面再次进行查询。
假设内网中有一台服务器名为adgk.local当我们需要访问它时需要在浏览器输入`http://adgk.local`，如果把dns搜索域设置成local那么你可以通过`http://adgk`来访问这台服务器也可以通过`http://adgk.local`来访问这台服务器。
