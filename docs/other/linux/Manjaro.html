<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Manjaro问题搜集 | Cute baby Sino Chen</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="Good good study ,day day up!">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/assets/css/0.styles.f3a5b470.css" as="style"><link rel="preload" href="/assets/js/app.943e2a60.js" as="script"><link rel="preload" href="/assets/js/3.0f19326b.js" as="script"><link rel="preload" href="/assets/js/1.7c96b034.js" as="script"><link rel="preload" href="/assets/js/74.53fa0ad9.js" as="script"><link rel="prefetch" href="/assets/js/10.b9b3b69e.js"><link rel="prefetch" href="/assets/js/11.e32ce8a0.js"><link rel="prefetch" href="/assets/js/12.4b57ce99.js"><link rel="prefetch" href="/assets/js/13.1d4dfc3c.js"><link rel="prefetch" href="/assets/js/14.0be6411d.js"><link rel="prefetch" href="/assets/js/15.7f4597b7.js"><link rel="prefetch" href="/assets/js/16.aaea8785.js"><link rel="prefetch" href="/assets/js/17.b319f03b.js"><link rel="prefetch" href="/assets/js/18.12eb3a51.js"><link rel="prefetch" href="/assets/js/19.fb51d7c6.js"><link rel="prefetch" href="/assets/js/20.2c593e45.js"><link rel="prefetch" href="/assets/js/21.3d9657db.js"><link rel="prefetch" href="/assets/js/22.73dbdde1.js"><link rel="prefetch" href="/assets/js/23.0c919f36.js"><link rel="prefetch" href="/assets/js/24.9dbeb203.js"><link rel="prefetch" href="/assets/js/25.01cd9d38.js"><link rel="prefetch" href="/assets/js/26.30779581.js"><link rel="prefetch" href="/assets/js/27.cf101748.js"><link rel="prefetch" href="/assets/js/28.996c9c19.js"><link rel="prefetch" href="/assets/js/29.ed3a62a8.js"><link rel="prefetch" href="/assets/js/30.33ddbed5.js"><link rel="prefetch" href="/assets/js/31.c4397848.js"><link rel="prefetch" href="/assets/js/32.bf2f1073.js"><link rel="prefetch" href="/assets/js/33.509af473.js"><link rel="prefetch" href="/assets/js/34.235eebe5.js"><link rel="prefetch" href="/assets/js/35.c70b6c99.js"><link rel="prefetch" href="/assets/js/36.13455efd.js"><link rel="prefetch" href="/assets/js/37.6b39df5d.js"><link rel="prefetch" href="/assets/js/38.02a3deeb.js"><link rel="prefetch" href="/assets/js/39.cb87f62d.js"><link rel="prefetch" href="/assets/js/4.3b1a6363.js"><link rel="prefetch" href="/assets/js/40.51036246.js"><link rel="prefetch" href="/assets/js/41.db5cbbfd.js"><link rel="prefetch" href="/assets/js/42.c62a5164.js"><link rel="prefetch" href="/assets/js/43.b9ed0e25.js"><link rel="prefetch" href="/assets/js/44.61e40d8c.js"><link rel="prefetch" href="/assets/js/45.e23a2854.js"><link rel="prefetch" href="/assets/js/46.69c2b178.js"><link rel="prefetch" href="/assets/js/47.79b1b2f6.js"><link rel="prefetch" href="/assets/js/48.8da7d14e.js"><link rel="prefetch" href="/assets/js/49.79535602.js"><link rel="prefetch" href="/assets/js/5.9b33242c.js"><link rel="prefetch" href="/assets/js/50.4020e511.js"><link rel="prefetch" href="/assets/js/51.372bce01.js"><link rel="prefetch" href="/assets/js/52.dc3653ab.js"><link rel="prefetch" href="/assets/js/53.ad29fb2d.js"><link rel="prefetch" href="/assets/js/54.5c63faf1.js"><link rel="prefetch" href="/assets/js/55.9dc5ea5b.js"><link rel="prefetch" href="/assets/js/56.249680e9.js"><link rel="prefetch" href="/assets/js/57.16eed10a.js"><link rel="prefetch" href="/assets/js/58.971f51e0.js"><link rel="prefetch" href="/assets/js/59.d000f160.js"><link rel="prefetch" href="/assets/js/6.9f0ac686.js"><link rel="prefetch" href="/assets/js/60.c57940cc.js"><link rel="prefetch" href="/assets/js/61.3691e7f1.js"><link rel="prefetch" href="/assets/js/62.17de2221.js"><link rel="prefetch" href="/assets/js/63.326dc3a1.js"><link rel="prefetch" href="/assets/js/64.c3c959a3.js"><link rel="prefetch" href="/assets/js/65.50491c7c.js"><link rel="prefetch" href="/assets/js/66.3e5fad28.js"><link rel="prefetch" href="/assets/js/67.8aac9501.js"><link rel="prefetch" href="/assets/js/68.a2a87dbf.js"><link rel="prefetch" href="/assets/js/69.ec95e5bf.js"><link rel="prefetch" href="/assets/js/7.8c8f1c63.js"><link rel="prefetch" href="/assets/js/70.124515e1.js"><link rel="prefetch" href="/assets/js/71.1dc3c1cf.js"><link rel="prefetch" href="/assets/js/72.72bbf7e8.js"><link rel="prefetch" href="/assets/js/73.98b13fd1.js"><link rel="prefetch" href="/assets/js/75.d979e00a.js"><link rel="prefetch" href="/assets/js/76.a0c047f8.js"><link rel="prefetch" href="/assets/js/77.86bbad80.js"><link rel="prefetch" href="/assets/js/78.ded73f85.js"><link rel="prefetch" href="/assets/js/79.aa8bee56.js"><link rel="prefetch" href="/assets/js/8.ba82d863.js"><link rel="prefetch" href="/assets/js/80.8e592b9d.js"><link rel="prefetch" href="/assets/js/81.324e6c55.js"><link rel="prefetch" href="/assets/js/82.d4db53cb.js"><link rel="prefetch" href="/assets/js/83.bae682d3.js"><link rel="prefetch" href="/assets/js/9.21518bf6.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f3a5b470.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-1aefc0b4><div data-v-1aefc0b4><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-1aefc0b4 data-v-1aefc0b4><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-25ba6db2 data-v-1aefc0b4 data-v-1aefc0b4><h3 class="title" data-v-25ba6db2 data-v-25ba6db2>Cute baby Sino Chen</h3> <p class="description" data-v-25ba6db2 data-v-25ba6db2>Good good study ,day day up!</p> <label id="box" class="inputBox" data-v-25ba6db2 data-v-25ba6db2><input type="password" value="" data-v-25ba6db2> <span data-v-25ba6db2>Konck! Knock!</span> <button data-v-25ba6db2>OK</button></label> <div class="footer" data-v-25ba6db2 data-v-25ba6db2><span data-v-25ba6db2><i class="iconfont reco-theme" data-v-25ba6db2></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-25ba6db2>vuePress-theme-reco</a></span> <span data-v-25ba6db2><i class="iconfont reco-copyright" data-v-25ba6db2></i> <a data-v-25ba6db2><span data-v-25ba6db2>chenkun</span>
            
          <span data-v-25ba6db2>2017 - </span>
          2022
        </a></span></div></div> <div class="hide" data-v-1aefc0b4><header class="navbar" data-v-1aefc0b4><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="Cute baby Sino Chen" class="logo"> <span class="site-name">Cute baby Sino Chen</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-blog"></i>
      Java
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Java Core</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/java/base/" class="nav-link"><i class="undefined"></i>
  Java基础
</a></li><li class="dropdown-subitem"><a href="/docs/java/advance/" class="nav-link"><i class="undefined"></i>
  Java进阶
</a></li><li class="dropdown-subitem"><a href="/docs/java/jvm/" class="nav-link"><i class="undefined"></i>
  虚拟机
</a></li></ul></li><li class="dropdown-item"><h4>Java FrameWork</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/java/framework/spring/" class="nav-link"><i class="undefined"></i>
  Spring
</a></li><li class="dropdown-subitem"><a href="/docs/java/framework/springboot/SpringBootAutoConfiguration.html" class="nav-link"><i class="undefined"></i>
  SpringBoot
</a></li><li class="dropdown-subitem"><a href="/docs/java/framework/mybatis/mybatis.html" class="nav-link"><i class="undefined"></i>
  Mybatis
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-blog"></i>
      web前端
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/frontWeb/javascript/" class="nav-link"><i class="undefined"></i>
  javascript基础
</a></li><li class="dropdown-item"><!----> <a href="/docs/frontWeb/vue/" class="nav-link"><i class="undefined"></i>
  vue知识点
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-blog"></i>
      Web通用
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/other/web/" class="nav-link"><i class="undefined"></i>
  Http
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-blog"></i>
      其他
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/other/git/" class="nav-link"><i class="undefined"></i>
  git
</a></li><li class="dropdown-item"><!----> <a href="/docs/other/database/" class="nav-link"><i class="undefined"></i>
  数据库
</a></li><li class="dropdown-item"><!----> <a href="/docs/other/linux/" class="nav-link router-link-active"><i class="undefined"></i>
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/docs/other/tools/" class="nav-link"><i class="undefined"></i>
  工具软件
</a></li><li class="dropdown-item"><!----> <a href="/docs/other/distributeservice/" class="nav-link"><i class="undefined"></i>
  分布式微服务
</a></li><li class="dropdown-item"><!----> <a href="/docs/other/training/" class="nav-link"><i class="undefined"></i>
  小组分享
</a></li><li class="dropdown-item"><!----> <a href="/docs/other/essay/TyporaPicgo.html" class="nav-link"><i class="undefined"></i>
  随笔杂记
</a></li></ul></div></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      Contact
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/chensino" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-1aefc0b4></div> <aside class="sidebar" data-v-1aefc0b4><div class="personal-info-wrapper" data-v-39576ba9 data-v-1aefc0b4><img src="/avatar.jpg" alt="author-avatar" class="personal-img" data-v-39576ba9> <h3 class="name" data-v-39576ba9>
    chenkun
  </h3> <div class="num" data-v-39576ba9><div data-v-39576ba9><h3 data-v-39576ba9>71</h3> <h6 data-v-39576ba9>Articles</h6></div> <div data-v-39576ba9><h3 data-v-39576ba9>15</h3> <h6 data-v-39576ba9>Tags</h6></div></div> <ul class="social-links" data-v-39576ba9></ul> <hr data-v-39576ba9></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-blog"></i>
      Java
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Java Core</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/java/base/" class="nav-link"><i class="undefined"></i>
  Java基础
</a></li><li class="dropdown-subitem"><a href="/docs/java/advance/" class="nav-link"><i class="undefined"></i>
  Java进阶
</a></li><li class="dropdown-subitem"><a href="/docs/java/jvm/" class="nav-link"><i class="undefined"></i>
  虚拟机
</a></li></ul></li><li class="dropdown-item"><h4>Java FrameWork</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/java/framework/spring/" class="nav-link"><i class="undefined"></i>
  Spring
</a></li><li class="dropdown-subitem"><a href="/docs/java/framework/springboot/SpringBootAutoConfiguration.html" class="nav-link"><i class="undefined"></i>
  SpringBoot
</a></li><li class="dropdown-subitem"><a href="/docs/java/framework/mybatis/mybatis.html" class="nav-link"><i class="undefined"></i>
  Mybatis
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-blog"></i>
      web前端
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/frontWeb/javascript/" class="nav-link"><i class="undefined"></i>
  javascript基础
</a></li><li class="dropdown-item"><!----> <a href="/docs/frontWeb/vue/" class="nav-link"><i class="undefined"></i>
  vue知识点
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-blog"></i>
      Web通用
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/other/web/" class="nav-link"><i class="undefined"></i>
  Http
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-blog"></i>
      其他
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/other/git/" class="nav-link"><i class="undefined"></i>
  git
</a></li><li class="dropdown-item"><!----> <a href="/docs/other/database/" class="nav-link"><i class="undefined"></i>
  数据库
</a></li><li class="dropdown-item"><!----> <a href="/docs/other/linux/" class="nav-link router-link-active"><i class="undefined"></i>
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/docs/other/tools/" class="nav-link"><i class="undefined"></i>
  工具软件
</a></li><li class="dropdown-item"><!----> <a href="/docs/other/distributeservice/" class="nav-link"><i class="undefined"></i>
  分布式微服务
</a></li><li class="dropdown-item"><!----> <a href="/docs/other/training/" class="nav-link"><i class="undefined"></i>
  小组分享
</a></li><li class="dropdown-item"><!----> <a href="/docs/other/essay/TyporaPicgo.html" class="nav-link"><i class="undefined"></i>
  随笔杂记
</a></li></ul></div></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      Contact
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/chensino" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <ul class="sidebar-links"><li><a href="/docs/other/linux/" aria-current="page" class="sidebar-link">本分类记录Linux的知识点</a></li><li><a href="/docs/other/linux/CommonUsedCMD.html" class="sidebar-link">Linux命令使用小技巧</a></li><li><a href="/docs/other/linux/Manjaro.html" aria-current="page" class="active sidebar-link">Manjaro问题搜集</a></li><li><a href="/docs/other/linux/TcpDump.html" class="sidebar-link">Linux下的抓报工具</a></li><li><a href="/docs/other/linux/Samba.html" class="sidebar-link">部署Samba</a></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-25ba6db2 data-v-1aefc0b4><h3 class="title" data-v-25ba6db2 data-v-25ba6db2>Manjaro问题搜集</h3> <!----> <label id="box" class="inputBox" data-v-25ba6db2 data-v-25ba6db2><input type="password" value="" data-v-25ba6db2> <span data-v-25ba6db2>Konck! Knock!</span> <button data-v-25ba6db2>OK</button></label> <div class="footer" data-v-25ba6db2 data-v-25ba6db2><span data-v-25ba6db2><i class="iconfont reco-theme" data-v-25ba6db2></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-25ba6db2>vuePress-theme-reco</a></span> <span data-v-25ba6db2><i class="iconfont reco-copyright" data-v-25ba6db2></i> <a data-v-25ba6db2><span data-v-25ba6db2>chenkun</span>
            
          <span data-v-25ba6db2>2017 - </span>
          2022
        </a></span></div></div> <div data-v-1aefc0b4><main class="page"><section><div class="page-title"><h1 class="title">Manjaro问题搜集</h1> <div data-v-f875f3fc><i class="iconfont reco-account" data-v-f875f3fc><span data-v-f875f3fc>chenkun</span></i> <i class="iconfont reco-date" data-v-f875f3fc><span data-v-f875f3fc>3/22/2022</span></i> <!----> <!----></div></div> <div class="theme-reco-content content__default"><h3 id="_1、降级软件包"><a href="#_1、降级软件包" class="header-anchor">#</a> 1、降级软件包</h3> <p>安装downgrade程序
<code>sudo pacman -S downgrade</code>
降级
<code>sudo DOWNGRADE_FROM_ALA=1 downgrade xxx包</code>
注意DOWNGRADE_FROM_ALA=1一定要按照我上边这样写，不能单独export DOWNGRADE_FROM_ALA=1
设置忽略升级的包
第二步会让你选择更新的时候是否要忽略更新，选择y的话，它会在/etc/pacman.conf添加一个忽略，如果不想湖绿，把下面的IgnorePkg注释即可</p> <p><img src="http://afatpig.oss-cn-chengdu.aliyuncs.com/blog/image-20220322171440300.png" alt="image-20220322171440300"></p> <h3 id="_2、开机报错failed-to-start-rotate-log-files"><a href="#_2、开机报错failed-to-start-rotate-log-files" class="header-anchor">#</a> 2、开机报错failed to start rotate log files</h3> <h4 id="_2-1-分析问题"><a href="#_2-1-分析问题" class="header-anchor">#</a> 2.1 分析问题</h4> <ol><li>logrotate是什么
按照老套路分析，先百度了一下logrotate是什么，参考，说白了就是个日志切割，和java里面的差不多。就是防止单文件日志过大，按照一定的规则切割成多个日志，或者删除，比如设置超过一个月直接删除，或者超过10M直接删除等等。</li> <li>查看logrotate是什么时候启动，以及启动后的状态。首先我们知道它是一个systemctl启动的service服务。那就到/lib/systemd/system下看一下ll |grep rotate</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code> ll<span class="token operator">|</span><span class="token function">grep</span> rota
-rw-r--r-- <span class="token number">1</span> root root  <span class="token number">870</span>  <span class="token number">1</span>月  <span class="token number">8</span>  <span class="token number">2021</span> logrotate.service
-rw-r--r-- <span class="token number">1</span> root root  <span class="token number">191</span>  <span class="token number">1</span>月  <span class="token number">8</span>  <span class="token number">2021</span> logrotate.timer
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>可以看到和<a href="https://blog.csdn.net/chen462488588/article/details/118737574?spm=1001.2014.3001.5501" target="_blank" rel="noopener noreferrer">这个问题<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>一模一样的套路。</p> <ol start="3"><li>到 logrotate.service查看它实际上执行的是什么命令</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$ <span class="token function">cat</span> logrotate.service     
<span class="token punctuation">[</span>Unit<span class="token punctuation">]</span>
<span class="token assign-left variable">Description</span><span class="token operator">=</span>Rotate log files
<span class="token assign-left variable">Documentation</span><span class="token operator">=</span>man:logrotate<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> man:logrotate.conf<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token assign-left variable">RequiresMountsFor</span><span class="token operator">=</span>/var/log
<span class="token assign-left variable">ConditionACPower</span><span class="token operator">=</span>true

<span class="token punctuation">[</span>Service<span class="token punctuation">]</span>
<span class="token assign-left variable">Type</span><span class="token operator">=</span>oneshot
<span class="token assign-left variable">ExecStart</span><span class="token operator">=</span>/usr/sbin/logrotate /etc/logrotate.conf

<span class="token comment"># performance options</span>
<span class="token assign-left variable">Nice</span><span class="token operator">=</span><span class="token number">19</span>
<span class="token assign-left variable">IOSchedulingClass</span><span class="token operator">=</span>best-effort
<span class="token assign-left variable">IOSchedulingPriority</span><span class="token operator">=</span><span class="token number">7</span>

<span class="token comment"># hardening options</span>
<span class="token comment">#  details: https://www.freedesktop.org/software/systemd/man/systemd.exec.html</span>
<span class="token comment">#  no ProtectHome for userdir logs</span>
<span class="token comment">#  no PrivateNetwork for mail deliviery</span>
<span class="token comment">#  no NoNewPrivileges for third party rotate scripts</span>
<span class="token comment">#  no RestrictSUIDSGID for creating setgid directories</span>
<span class="token assign-left variable">LockPersonality</span><span class="token operator">=</span>true
<span class="token assign-left variable">MemoryDenyWriteExecute</span><span class="token operator">=</span>true
<span class="token assign-left variable">PrivateDevices</span><span class="token operator">=</span>true
<span class="token assign-left variable">PrivateTmp</span><span class="token operator">=</span>true
<span class="token assign-left variable">ProtectClock</span><span class="token operator">=</span>true
<span class="token assign-left variable">ProtectControlGroups</span><span class="token operator">=</span>true
<span class="token assign-left variable">ProtectHostname</span><span class="token operator">=</span>true
<span class="token assign-left variable">ProtectKernelLogs</span><span class="token operator">=</span>true
<span class="token assign-left variable">ProtectKernelModules</span><span class="token operator">=</span>true
<span class="token assign-left variable">ProtectKernelTunables</span><span class="token operator">=</span>true
<span class="token assign-left variable">ProtectSystem</span><span class="token operator">=</span>full
<span class="token assign-left variable">RestrictNamespaces</span><span class="token operator">=</span>true
<span class="token assign-left variable">RestrictRealtime</span><span class="token operator">=</span>true


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><p>可以看到<code>ExecStart=/usr/sbin/logrotate /etc/logrotate.conf</code>
执行的是这个命令，那就好办了，手动以debug模式执行一下此命令</p> <ol start="4"><li>查看执行结果</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$ <span class="token function">sudo</span> <span class="token function">logrotate</span> --debug /etc/logrotate.conf                              
<span class="token punctuation">[</span>sudo<span class="token punctuation">]</span> chenkun 的密码：
WARNING: <span class="token function">logrotate</span> <span class="token keyword">in</span> debug mode does nothing except printing debug messages<span class="token operator">!</span>  Consider using verbose mode <span class="token punctuation">(</span>-v<span class="token punctuation">)</span> instead <span class="token keyword">if</span> this is not what you want.

reading config <span class="token function">file</span> /etc/logrotate.conf
including /etc/logrotate.d
reading config <span class="token function">file</span> cups
reading config <span class="token function">file</span> lirc
reading config <span class="token function">file</span> mysqlrouter
error: mysqlrouter:31 unknown option <span class="token string">'var'</span> -- ignoring line
error: mysqlrouter:45 unexpected <span class="token punctuation">}</span>
error: found error <span class="token keyword">in</span> <span class="token function">file</span> mysqlrouter, skipping
reading config <span class="token function">file</span> nginx
reading config <span class="token function">file</span> samba
warning: <span class="token string">'monthly'</span> overrides previously specified <span class="token string">'weekly'</span>
Reading state from file: /var/lib/logrotate.status
Allocating <span class="token builtin class-name">hash</span> table <span class="token keyword">for</span> state file, size <span class="token number">64</span> entries
Creating new state
Creating new state
Creating new state
Creating new state
Creating new state
Creating new state
Creating new state
Creating new state
Creating new state
Creating new state
Creating new state

Handling <span class="token number">6</span> logs

rotating pattern: /var/log/cups/*_log  weekly <span class="token punctuation">(</span><span class="token number">4</span> rotations<span class="token punctuation">)</span>
empty log files are not rotated, old logs are removed
considering log /var/log/cups/access_log
  Now: <span class="token number">2021</span>-07-15 09:24
  Last rotated at <span class="token number">2021</span>-07-11 <span class="token number">16</span>:22
  log does not need rotating <span class="token punctuation">(</span>log has been rotated at <span class="token number">2021</span>-07-11 <span class="token number">16</span>:22, <span class="token function">which</span> is <span class="token function">less</span> than a week ago<span class="token punctuation">)</span>
considering log /var/log/cups/error_log
  Now: <span class="token number">2021</span>-07-15 09:24
  Last rotated at <span class="token number">2021</span>-07-11 <span class="token number">16</span>:22
  log does not need rotating <span class="token punctuation">(</span>log has been rotated at <span class="token number">2021</span>-07-11 <span class="token number">16</span>:22, <span class="token function">which</span> is <span class="token function">less</span> than a week ago<span class="token punctuation">)</span>

rotating pattern: /var/log/lircd  weekly <span class="token punctuation">(</span><span class="token number">4</span> rotations<span class="token punctuation">)</span>
empty log files are not rotated, old logs are removed
considering log /var/log/lircd
  log /var/log/lircd does not exist -- skipping

rotating pattern: /var/log/nginx/*log  weekly <span class="token punctuation">(</span><span class="token number">4</span> rotations<span class="token punctuation">)</span>
empty log files are not rotated, old logs are removed
considering log /var/log/nginx/access.log
  Now: <span class="token number">2021</span>-07-15 09:24
  Last rotated at <span class="token number">2021</span>-06-02 08:34
  log does not need rotating <span class="token punctuation">(</span>log is empty<span class="token punctuation">)</span>
not running postrotate script, since no logs were rotated

rotating pattern: /var/log/samba/log.smbd /var/log/samba/log.nmbd /var/log/samba/*.log  weekly <span class="token punctuation">(</span><span class="token number">4</span> rotations<span class="token punctuation">)</span>
empty log files are not rotated, old logs are removed
considering log /var/log/samba/log.smbd
  log /var/log/samba/log.smbd does not exist -- skipping
considering log /var/log/samba/log.nmbd
  log /var/log/samba/log.nmbd does not exist -- skipping
considering log /var/log/samba/*.log
  log /var/log/samba/*.log does not exist -- skipping

rotating pattern: /var/log/wtmp  monthly <span class="token punctuation">(</span><span class="token number">1</span> rotations<span class="token punctuation">)</span>
empty log files are rotated, only log files <span class="token operator">&gt;=</span> <span class="token number">1048576</span> bytes are rotated, old logs are removed
considering log /var/log/wtmp
  Now: <span class="token number">2021</span>-07-15 09:24
  Last rotated at <span class="token number">2021</span>-03-20 <span class="token number">18</span>:00
  log does not need rotating <span class="token punctuation">(</span><span class="token string">'minsize'</span> directive is used and the log size is smaller than the minsize value<span class="token punctuation">)</span>

rotating pattern: /var/log/btmp  monthly <span class="token punctuation">(</span><span class="token number">1</span> rotations<span class="token punctuation">)</span>
empty log files are rotated, old logs are removed
considering log /var/log/btmp
  Now: <span class="token number">2021</span>-07-15 09:24
  Last rotated at <span class="token number">2021</span>-07-01 <span class="token number">19</span>:33
  log does not need rotating <span class="token punctuation">(</span>log has been rotated at <span class="token number">2021</span>-07-01 <span class="token number">19</span>:33, <span class="token function">which</span> is <span class="token function">less</span> than a month ago<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br></div></div><ol start="5"><li><p>在日志中找error</p> <p><img src="http://afatpig.oss-cn-chengdu.aliyuncs.com/blog/image-20220322171948840.png" alt="image-20220322171948840"></p></li> <li><p>报错很明显了是mysqlroute的日志切割失败了。</p></li> <li><p>logrotate其实是被很多程序都使用了，其配置文件在/etc/logrotate.d下</p> <p><img src="http://afatpig.oss-cn-chengdu.aliyuncs.com/blog/image-20220322172023905.png" alt="image-20220322172023905"></p></li></ol> <p>可以看到nginx ，mysqlrouter，Samba等都用了logrotate，并且他们都有自己的配置，根据上面我们已经知道了是mysqlrouter配置有问题，我们只需要打开nginx的配置和mysqlrouter对比就知道了。经过比我我的mysqlrouter的配置文件在var前面少了一个/ 加上就好了</p> <p><img src="http://afatpig.oss-cn-chengdu.aliyuncs.com/blog/image-20220322172038617.png" alt="image-20220322172038617"></p> <h3 id="linux下输入法无法输入中文中括号问题"><a href="#linux下输入法无法输入中文中括号问题" class="header-anchor">#</a> linux下输入法无法输入中文中括号问题</h3> <p>如果使用的是fcitx5，修改/usr/share/fcitx5/punctuation/punc.mb.zh_CN下的对应符号即可，打开文件有两列，第一列代表英文
状态下的符号，第二列是中文下符号。
有时发现无论怎么输入都只有英文，那么就续呀点击一下输入法上的半角符号</p> <h3 id="_3、美化"><a href="#_3、美化" class="header-anchor">#</a> 3、美化</h3> <p>kde设置proxy有个很大的bug,就是无法全局，搞笑的是通过kde设置的proxy,它自己都无法使用，在国内用kde下载主题、图标等根本下载不动。</p> <p>解决办法就是挂梯子，下载后手动安装，</p> <p><img src="http://afatpig.oss-cn-chengdu.aliyuncs.com/blog/image-20220418155819498.png" alt="image-20220418155819498"></p> <p><img src="http://afatpig.oss-cn-chengdu.aliyuncs.com/blog/image-20220418155847045.png" alt="image-20220418155847045"></p> <p><img src="http://afatpig.oss-cn-chengdu.aliyuncs.com/blog/image-20220418155927678.png" alt="image-20220418155927678"></p> <p><img src="http://afatpig.oss-cn-chengdu.aliyuncs.com/blog/image-20220418155956979.png" alt="image-20220418155956979"></p> <h3 id="_4、设置yakuake提示没有权限修改文件"><a href="#_4、设置yakuake提示没有权限修改文件" class="header-anchor">#</a> 4、设置yakuake提示没有权限修改文件</h3> <ol><li>修改yakuake的文字大小</li></ol> <p><img src="http://afatpig.oss-cn-chengdu.aliyuncs.com/blog/image-20220419110311199.png" alt="image-20220419110311199"></p> <p><img src="http://afatpig.oss-cn-chengdu.aliyuncs.com/blog/image-20220419110401735.png" alt="image-20220419110401735"></p> <ol start="2"><li>保存时会报错，大概是没有<code>/usr/share/konsole</code>的权限</li> <li>添加一下权限就行了</li></ol> <p>​		给当前用户添加一下权限，<code>chmod 666 xxx</code></p> <h3 id="_3、manjaro不支持mysql"><a href="#_3、manjaro不支持mysql" class="header-anchor">#</a> 3、Manjaro不支持Mysql</h3> <blockquote><p>在Manjaro上使用mysql,经常会遇到libicu不兼容问题，即使解决了，下次系统滚动升级可能又会出现</p></blockquote> <h4 id="_3-1-使用mariadb代替mysql"><a href="#_3-1-使用mariadb代替mysql" class="header-anchor">#</a> 3.1 使用MariaDB代替mysql</h4> <p><img src="http://afatpig.oss-cn-chengdu.aliyuncs.com/blog/image-20220502211444881.png" alt="image-20220502211444881"></p> <h4 id="_3-2-使用docker安装mysql"><a href="#_3-2-使用docker安装mysql" class="header-anchor">#</a> 3.2 使用docker安装Mysql</h4> <h3 id="_4、manjaro设置dns"><a href="#_4、manjaro设置dns" class="header-anchor">#</a> 4、Manjaro设置DNS</h3> <p><strong>背景</strong></p> <blockquote><p>用双网卡同时上内外网，有时一个域名是内网才能解析的，比如我司的iccm.sonoscape.com，这个是一个内网域名，要走内部DNS才能访问到，</p> <p>但是公司因该是有两个DNS服务器，一个用来解析外网访问xxx.sonoscape.com，另一个是用来访问内网的xxx.sonoscape.com,</p></blockquote></div></section> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">7/11/2022, 2:44:42 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/docs/other/linux/CommonUsedCMD.html" class="prev">
            Linux命令使用小技巧
          </a></span> <span class="next"><a href="/docs/other/linux/TcpDump.html">
            Linux下的抓报工具
          </a></span></p></div> <div class="comments-wrapper"><!----></div> <ul class="side-bar sub-sidebar-wrapper" style="width:12rem;" data-v-cb1513f6><li class="level-3" data-v-cb1513f6><a href="/docs/other/linux/Manjaro.html#_1、降级软件包" class="sidebar-link reco-side-_1、降级软件包" data-v-cb1513f6>1、降级软件包</a></li><li class="level-3" data-v-cb1513f6><a href="/docs/other/linux/Manjaro.html#_2、开机报错failed-to-start-rotate-log-files" class="sidebar-link reco-side-_2、开机报错failed-to-start-rotate-log-files" data-v-cb1513f6>2、开机报错failed to start rotate log files</a></li><li class="level-3" data-v-cb1513f6><a href="/docs/other/linux/Manjaro.html#linux下输入法无法输入中文中括号问题" class="sidebar-link reco-side-linux下输入法无法输入中文中括号问题" data-v-cb1513f6>linux下输入法无法输入中文中括号问题</a></li><li class="level-3" data-v-cb1513f6><a href="/docs/other/linux/Manjaro.html#_3、美化" class="sidebar-link reco-side-_3、美化" data-v-cb1513f6>3、美化</a></li><li class="level-3" data-v-cb1513f6><a href="/docs/other/linux/Manjaro.html#_4、设置yakuake提示没有权限修改文件" class="sidebar-link reco-side-_4、设置yakuake提示没有权限修改文件" data-v-cb1513f6>4、设置yakuake提示没有权限修改文件</a></li><li class="level-3" data-v-cb1513f6><a href="/docs/other/linux/Manjaro.html#_3、manjaro不支持mysql" class="sidebar-link reco-side-_3、manjaro不支持mysql" data-v-cb1513f6>3、Manjaro不支持Mysql</a></li><li class="level-3" data-v-cb1513f6><a href="/docs/other/linux/Manjaro.html#_4、manjaro设置dns" class="sidebar-link reco-side-_4、manjaro设置dns" data-v-cb1513f6>4、Manjaro设置DNS</a></li></ul></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div></div></div>
    <script src="/assets/js/app.943e2a60.js" defer></script><script src="/assets/js/3.0f19326b.js" defer></script><script src="/assets/js/1.7c96b034.js" defer></script><script src="/assets/js/74.53fa0ad9.js" defer></script>
  </body>
</html>
