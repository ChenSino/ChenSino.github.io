import{_ as t}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as i,o,c as l,a,b as n,d as r,e}from"./app-eaM1OiHO.js";const c={},p=e(`<h3 id="_1、降级软件包" tabindex="-1"><a class="header-anchor" href="#_1、降级软件包"><span>1、降级软件包</span></a></h3><p>安装downgrade程序 <code>sudo pacman -S downgrade</code> 降级 <code>sudo DOWNGRADE_FROM_ALA=1 downgrade xxx包</code> 注意DOWNGRADE_FROM_ALA=1一定要按照我上边这样写，不能单独export DOWNGRADE_FROM_ALA=1 设置忽略升级的包 第二步会让你选择更新的时候是否要忽略更新，选择y的话，它会在/etc/pacman.conf添加一个忽略，如果不想湖绿，把下面的IgnorePkg注释即可</p><p><img src="https://afatpig.oss-cn-chengdu.aliyuncs.com/blog/image-20220322171440300.png" alt="image-20220322171440300"></p><h3 id="_2、开机报错failed-to-start-rotate-log-files" tabindex="-1"><a class="header-anchor" href="#_2、开机报错failed-to-start-rotate-log-files"><span>2、开机报错failed to start rotate log files</span></a></h3><h4 id="_2-1-分析问题" tabindex="-1"><a class="header-anchor" href="#_2-1-分析问题"><span>2.1 分析问题</span></a></h4><ol><li>logrotate是什么 按照老套路分析，先百度了一下logrotate是什么，参考，说白了就是个日志切割，和java里面的差不多。就是防止单文件日志过大，按照一定的规则切割成多个日志，或者删除，比如设置超过一个月直接删除，或者超过10M直接删除等等。</li><li>查看logrotate是什么时候启动，以及启动后的状态。首先我们知道它是一个systemctl启动的service服务。那就到/lib/systemd/system下看一下ll |grep rotate</li></ol><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code> ll<span class="token operator">|</span><span class="token function">grep</span> rota
-rw-r--r-- <span class="token number">1</span> root root  <span class="token number">870</span>  <span class="token number">1</span>月  <span class="token number">8</span>  <span class="token number">2021</span> logrotate.service
-rw-r--r-- <span class="token number">1</span> root root  <span class="token number">191</span>  <span class="token number">1</span>月  <span class="token number">8</span>  <span class="token number">2021</span> logrotate.timer
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,7),d={href:"https://blog.csdn.net/chen462488588/article/details/118737574?spm=1001.2014.3001.5501",target:"_blank",rel:"noopener noreferrer"},u=e(`<div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>$ <span class="token function">cat</span> logrotate.service     
<span class="token punctuation">[</span>Unit<span class="token punctuation">]</span>
<span class="token assign-left variable">Description</span><span class="token operator">=</span>Rotate log files
<span class="token assign-left variable">Documentation</span><span class="token operator">=</span>man:logrotate<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> man:logrotate.conf<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token assign-left variable">RequiresMountsFor</span><span class="token operator">=</span>/var/log
<span class="token assign-left variable">ConditionACPower</span><span class="token operator">=</span>true

<span class="token punctuation">[</span>Service<span class="token punctuation">]</span>
<span class="token assign-left variable">Type</span><span class="token operator">=</span>oneshot
<span class="token assign-left variable">ExecStart</span><span class="token operator">=</span>/usr/sbin/logrotate /etc/logrotate.conf

<span class="token comment"># performance options</span>
<span class="token assign-left variable">Nice</span><span class="token operator">=</span><span class="token number">19</span>
<span class="token assign-left variable">IOSchedulingClass</span><span class="token operator">=</span>best-effort
<span class="token assign-left variable">IOSchedulingPriority</span><span class="token operator">=</span><span class="token number">7</span>

<span class="token comment"># hardening options</span>
<span class="token comment">#  details: https://www.freedesktop.org/software/systemd/man/systemd.exec.html</span>
<span class="token comment">#  no ProtectHome for userdir logs</span>
<span class="token comment">#  no PrivateNetwork for mail deliviery</span>
<span class="token comment">#  no NoNewPrivileges for third party rotate scripts</span>
<span class="token comment">#  no RestrictSUIDSGID for creating setgid directories</span>
<span class="token assign-left variable">LockPersonality</span><span class="token operator">=</span>true
<span class="token assign-left variable">MemoryDenyWriteExecute</span><span class="token operator">=</span>true
<span class="token assign-left variable">PrivateDevices</span><span class="token operator">=</span>true
<span class="token assign-left variable">PrivateTmp</span><span class="token operator">=</span>true
<span class="token assign-left variable">ProtectClock</span><span class="token operator">=</span>true
<span class="token assign-left variable">ProtectControlGroups</span><span class="token operator">=</span>true
<span class="token assign-left variable">ProtectHostname</span><span class="token operator">=</span>true
<span class="token assign-left variable">ProtectKernelLogs</span><span class="token operator">=</span>true
<span class="token assign-left variable">ProtectKernelModules</span><span class="token operator">=</span>true
<span class="token assign-left variable">ProtectKernelTunables</span><span class="token operator">=</span>true
<span class="token assign-left variable">ProtectSystem</span><span class="token operator">=</span>full
<span class="token assign-left variable">RestrictNamespaces</span><span class="token operator">=</span>true
<span class="token assign-left variable">RestrictRealtime</span><span class="token operator">=</span>true
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以看到<code>ExecStart=/usr/sbin/logrotate /etc/logrotate.conf</code> 执行的是这个命令，那就好办了，手动以debug模式执行一下此命令 4. 查看执行结果</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>$ <span class="token function">sudo</span> <span class="token function">logrotate</span> <span class="token parameter variable">--debug</span> /etc/logrotate.conf                              
<span class="token punctuation">[</span>sudo<span class="token punctuation">]</span> chenkun 的密码：
WARNING: <span class="token function">logrotate</span> <span class="token keyword">in</span> debug mode does nothing except printing debug messages<span class="token operator">!</span>  Consider using verbose mode <span class="token punctuation">(</span>-v<span class="token punctuation">)</span> instead <span class="token keyword">if</span> this is not what you want.

reading config <span class="token function">file</span> /etc/logrotate.conf
including /etc/logrotate.d
reading config <span class="token function">file</span> cups
reading config <span class="token function">file</span> lirc
reading config <span class="token function">file</span> mysqlrouter
error: mysqlrouter:31 unknown option <span class="token string">&#39;var&#39;</span> -- ignoring line
error: mysqlrouter:45 unexpected <span class="token punctuation">}</span>
error: found error <span class="token keyword">in</span> <span class="token function">file</span> mysqlrouter, skipping
reading config <span class="token function">file</span> nginx
reading config <span class="token function">file</span> samba
warning: <span class="token string">&#39;monthly&#39;</span> overrides previously specified <span class="token string">&#39;weekly&#39;</span>
Reading state from file: /var/lib/logrotate.status
Allocating <span class="token builtin class-name">hash</span> table <span class="token keyword">for</span> state file, size <span class="token number">64</span> entries
Creating new state
Creating new state
Creating new state
Creating new state
Creating new state
Creating new state
Creating new state
Creating new state
Creating new state
Creating new state
Creating new state

Handling <span class="token number">6</span> logs

rotating pattern: /var/log/cups/*_log  weekly <span class="token punctuation">(</span><span class="token number">4</span> rotations<span class="token punctuation">)</span>
empty log files are not rotated, old logs are removed
considering log /var/log/cups/access_log
  Now: <span class="token number">2021</span>-07-15 09:24
  Last rotated at <span class="token number">2021</span>-07-11 <span class="token number">16</span>:22
  log does not need rotating <span class="token punctuation">(</span>log has been rotated at <span class="token number">2021</span>-07-11 <span class="token number">16</span>:22, <span class="token function">which</span> is <span class="token function">less</span> than a week ago<span class="token punctuation">)</span>
considering log /var/log/cups/error_log
  Now: <span class="token number">2021</span>-07-15 09:24
  Last rotated at <span class="token number">2021</span>-07-11 <span class="token number">16</span>:22
  log does not need rotating <span class="token punctuation">(</span>log has been rotated at <span class="token number">2021</span>-07-11 <span class="token number">16</span>:22, <span class="token function">which</span> is <span class="token function">less</span> than a week ago<span class="token punctuation">)</span>

rotating pattern: /var/log/lircd  weekly <span class="token punctuation">(</span><span class="token number">4</span> rotations<span class="token punctuation">)</span>
empty log files are not rotated, old logs are removed
considering log /var/log/lircd
  log /var/log/lircd does not exist -- skipping

rotating pattern: /var/log/nginx/*log  weekly <span class="token punctuation">(</span><span class="token number">4</span> rotations<span class="token punctuation">)</span>
empty log files are not rotated, old logs are removed
considering log /var/log/nginx/access.log
  Now: <span class="token number">2021</span>-07-15 09:24
  Last rotated at <span class="token number">2021</span>-06-02 08:34
  log does not need rotating <span class="token punctuation">(</span>log is empty<span class="token punctuation">)</span>
not running postrotate script, since no logs were rotated

rotating pattern: /var/log/samba/log.smbd /var/log/samba/log.nmbd /var/log/samba/*.log  weekly <span class="token punctuation">(</span><span class="token number">4</span> rotations<span class="token punctuation">)</span>
empty log files are not rotated, old logs are removed
considering log /var/log/samba/log.smbd
  log /var/log/samba/log.smbd does not exist -- skipping
considering log /var/log/samba/log.nmbd
  log /var/log/samba/log.nmbd does not exist -- skipping
considering log /var/log/samba/*.log
  log /var/log/samba/*.log does not exist -- skipping

rotating pattern: /var/log/wtmp  monthly <span class="token punctuation">(</span><span class="token number">1</span> rotations<span class="token punctuation">)</span>
empty log files are rotated, only log files <span class="token operator">&gt;=</span> <span class="token number">1048576</span> bytes are rotated, old logs are removed
considering log /var/log/wtmp
  Now: <span class="token number">2021</span>-07-15 09:24
  Last rotated at <span class="token number">2021</span>-03-20 <span class="token number">18</span>:00
  log does not need rotating <span class="token punctuation">(</span><span class="token string">&#39;minsize&#39;</span> directive is used and the log size is smaller than the minsize value<span class="token punctuation">)</span>

rotating pattern: /var/log/btmp  monthly <span class="token punctuation">(</span><span class="token number">1</span> rotations<span class="token punctuation">)</span>
empty log files are rotated, old logs are removed
considering log /var/log/btmp
  Now: <span class="token number">2021</span>-07-15 09:24
  Last rotated at <span class="token number">2021</span>-07-01 <span class="token number">19</span>:33
  log does not need rotating <span class="token punctuation">(</span>log has been rotated at <span class="token number">2021</span>-07-01 <span class="token number">19</span>:33, <span class="token function">which</span> is <span class="token function">less</span> than a month ago<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="5"><li>在日志中找error <img src="https://afatpig.oss-cn-chengdu.aliyuncs.com/blog/image-20220322171948840.png" alt="image-20220322171948840"></li><li>报错很明显了是mysqlroute的日志切割失败了。</li><li>logrotate其实是被很多程序都使用了，其配置文件在/etc/logrotate.d下 <img src="https://afatpig.oss-cn-chengdu.aliyuncs.com/blog/image-20220322172023905.png" alt="image-20220322172023905"></li></ol><p>可以看到nginx ，mysqlrouter，Samba等都用了logrotate，并且他们都有自己的配置，根据上面我们已经知道了是mysqlrouter配置有问题，我们只需要打开nginx的配置和mysqlrouter对比就知道了。经过比我我的mysqlrouter的配置文件在var前面少了一个/ 加上就好了</p><p><img src="https://afatpig.oss-cn-chengdu.aliyuncs.com/blog/image-20220322172038617.png" alt="image-20220322172038617"></p><h3 id="linux下输入法无法输入中文中括号问题" tabindex="-1"><a class="header-anchor" href="#linux下输入法无法输入中文中括号问题"><span>linux下输入法无法输入中文中括号问题</span></a></h3><p>如果使用的是fcitx5，修改/usr/share/fcitx5/punctuation/punc.mb.zh_CN下的对应符号即可，打开文件有两列，第一列代表英文 状态下的符号，第二列是中文下符号。 有时发现无论怎么输入都只有英文，那么就续呀点击一下输入法上的半角符号</p><h3 id="_3、美化" tabindex="-1"><a class="header-anchor" href="#_3、美化"><span>3、美化</span></a></h3><p>kde设置proxy有个很大的bug,就是无法全局，搞笑的是通过kde设置的proxy,它自己都无法使用，在国内用kde下载主题、图标等根本下载不动。</p><p>解决办法就是挂梯子，下载后手动安装，</p><p><img src="https://afatpig.oss-cn-chengdu.aliyuncs.com/blog/image-20220418155819498.png" alt="image-20220418155819498"></p><p><img src="https://afatpig.oss-cn-chengdu.aliyuncs.com/blog/image-20220418155847045.png" alt="image-20220418155847045"></p><p><img src="https://afatpig.oss-cn-chengdu.aliyuncs.com/blog/image-20220418155927678.png" alt="image-20220418155927678"></p><p><img src="https://afatpig.oss-cn-chengdu.aliyuncs.com/blog/image-20220418155956979.png" alt="image-20220418155956979"></p><h3 id="_4、设置yakuake提示没有权限修改文件" tabindex="-1"><a class="header-anchor" href="#_4、设置yakuake提示没有权限修改文件"><span>4、设置yakuake提示没有权限修改文件</span></a></h3><ol><li>修改yakuake的文字大小</li></ol><p><img src="https://afatpig.oss-cn-chengdu.aliyuncs.com/blog/image-20220419110311199.png" alt="image-20220419110311199"></p><p><img src="https://afatpig.oss-cn-chengdu.aliyuncs.com/blog/image-20220419110401735.png" alt="image-20220419110401735"></p><ol start="2"><li>保存时会报错，大概是没有<code>/usr/share/konsole</code>的权限</li><li>添加一下权限就行了</li></ol><p>​ 给当前用户添加一下权限，<code>chmod 666 xxx</code></p><h3 id="_4、manjaro不支持mysql" tabindex="-1"><a class="header-anchor" href="#_4、manjaro不支持mysql"><span>4、Manjaro不支持Mysql</span></a></h3><blockquote><p>在Manjaro上使用mysql,经常会遇到libicu不兼容问题，即使解决了，下次系统滚动升级可能又会出现</p></blockquote><h4 id="_4-1-使用mariadb代替mysql" tabindex="-1"><a class="header-anchor" href="#_4-1-使用mariadb代替mysql"><span>4.1 使用MariaDB代替mysql</span></a></h4><p><img src="https://afatpig.oss-cn-chengdu.aliyuncs.com/blog/image-20220502211444881.png" alt="image-20220502211444881"></p><h4 id="_4-2-使用docker安装mysql" tabindex="-1"><a class="header-anchor" href="#_4-2-使用docker安装mysql"><span>4.2 使用docker安装Mysql</span></a></h4><h3 id="_5、manjaro设置dns" tabindex="-1"><a class="header-anchor" href="#_5、manjaro设置dns"><span>5、Manjaro设置DNS</span></a></h3><blockquote><p>用双网卡同时上内外网，有时一个域名是内网才能解析的，比如我司的iccm.sonoscape.com，这个是一个内网域名，要走内部DNS才能访问到，</p><p>但是公司因该是有两个DNS服务器，一个用来解析外网访问xxx.sonoscape.com，另一个是用来访问内网的xxx.sonoscape.com,</p></blockquote><h3 id="_6、manjaro-fcitx5中文大括号问题" tabindex="-1"><a class="header-anchor" href="#_6、manjaro-fcitx5中文大括号问题"><span>6、Manjaro fcitx5中文大括号问题</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">vim</span> /usr/share/fcitx5/punctuation/punc.mb.zh_CN
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>修改对应的行符号就可以了</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token punctuation">[</span> 【
<span class="token punctuation">]</span> 】
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7、分支管理" tabindex="-1"><a class="header-anchor" href="#_7、分支管理"><span>7、分支管理</span></a></h3><h4 id="_7-1-概述" tabindex="-1"><a class="header-anchor" href="#_7-1-概述"><span>7.1 概述</span></a></h4><p>Template:重要 One of the many features that sets Manjaro apart from other Arch-based distributions is that it uses its own dedicated software branches, rather than relying on those provided by Arch itself. In fact, to ensure continued stability and reliability, Manjaro actually uses three distinct branches:</p><ul><li><strong>Stable branch</strong> : The packages that come to stable have gone through roughly a couple of weeks testing by the users of the Unstable/Testing repos, before they get the packages. These packages are usually free of any problems.</li><li><strong>Testing branch</strong>: This is the second line of defense. Being a larger number of users than those using Unstable, they refine the work done prior to them by providing feedback on the packages they recieve on updates.</li><li><strong>Unstable branch</strong> : Unstable is synced several times a day with Arch package releases. Only a subset of Arch packages are modified to suit Manjaro. Those that use Unstable need to have the skills to get themselves out of trouble when they move their system to this branch. They are the Manjaro users who are most likely to need to use such skills. Due to the feedback from the users of the Unstable repo, many issues are caught and fixed at this level. Although the very latest software will be located here, using the unstable branch is usually safe but - in rare cases - may cause issues with your system!</li></ul><p><strong>Summing up</strong> , Manjaro packages start their lives in the unstable branch. Once they are a deemed stable, they are moved to the testing branch, where more tests will be realized to ensure the package is ready to be submitted to the stable branch.</p><div class="hint-container note"><p class="hint-container-title">Note on unstable branch</p><p>Remember: Manjaro specific packages such as kernels, kernel modules and Manjaro applications enter the repo on unstable branch and it is those packages which are considered unstable when they enter. Unmodifed packages synced from Arch repo are considered stable as they have already been vetted by Archlinux Community.</p></div><h4 id="_7-2切换分支" tabindex="-1"><a class="header-anchor" href="#_7-2切换分支"><span>7.2切换分支</span></a></h4><p>In order to access a branch, you need to change your pacman-mirrors configuration.</p><p>You should substitute the value colored in green (for illustrative purposes only) to one of the following: stable, testing or unstable.</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">sudo</span> pacman-mirrors <span class="token parameter variable">--api</span> --set-branch <span class="token punctuation">{</span>branch<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>After you changed the branch, rebuild the mirrorlist and update your packages:</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">sudo</span> pacman-mirrors <span class="token parameter variable">--fasttrack</span> <span class="token number">5</span> <span class="token operator">&amp;&amp;</span> <span class="token function">sudo</span> pacman <span class="token parameter variable">-Syyu</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_7-3-how-do-i-go-back-after-changing-to-one-of-the-testing-branches" tabindex="-1"><a class="header-anchor" href="#_7-3-how-do-i-go-back-after-changing-to-one-of-the-testing-branches"><span>7.3 How do I go back after changing to one of the testing branches?</span></a></h4><p>Going back to the stable branch is easy. All you have to do is to repeat the above, and use stable as the branch value.</p><p>Be aware that after switching to a more stable branch you will receive messages from pacman, informing about newer packages installed than available in the repo. Don&#39;t be alarmed as the situation will resolve itself when the packages reaches your current branch.</p><p>If for whatever reason you do wish to also &#39;downgrade&#39; packages while changing branches add an extra u to the pacman command:</p><p><code>sudo pacman -Syyuu</code></p><h3 id="_8、wine安装exe报错" tabindex="-1"><a class="header-anchor" href="#_8、wine安装exe报错"><span>8、wine安装exe报错</span></a></h3><p>报错内容</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>
Runtime Error <span class="token punctuation">(</span>at - <span class="token number">1</span>:0<span class="token punctuation">)</span>:
Cannot Import dll:C:<span class="token punctuation">\\</span>users<span class="token punctuation">\\</span>xxx<span class="token punctuation">\\</span>Temp<span class="token punctuation">\\</span>is-00IEG.tmp<span class="token punctuation">\\</span>isskin.dll
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>解决方法</p><div class="language-markdown line-numbers-mode" data-ext="md" data-title="md"><pre class="language-markdown"><code><span class="token list punctuation">1.</span> 安装winetricks
   <span class="token code-snippet code keyword">\`sudo pacman -S winetricks\`</span>
<span class="token list punctuation">2.</span> 用winetricks安装必要的依赖
  <span class="token code-snippet code keyword">\`winetricks vcrun6sp6\`</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>参考：</p><p>https://www.linuxquestions.org/questions/red-hat-31/wine-runtime-error-isskin-dll-issue-879119/</p><p>https://wiki.winehq.org/Winetricks</p><h3 id="_9、解压缩中文乱码" tabindex="-1"><a class="header-anchor" href="#_9、解压缩中文乱码"><span>9、解压缩中文乱码</span></a></h3><p>使用下面命令：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">unzip</span> <span class="token parameter variable">-O</span> cp936  <span class="token string">&#39;xxx.zip&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ArchLinux 需要安装 unzip-iconv</p><h3 id="_10、vmware使用问题" tabindex="-1"><a class="header-anchor" href="#_10、vmware使用问题"><span>10、vmware使用问题</span></a></h3><p>在manjaro安装了vmware17版本，然后安了一个deepin系统，无法使用虚拟网卡，以为是deepin的问题，然后换其他发行版，同样不行。然后开启了排查之路</p><p>尝试路线：</p><ol><li>开始以为是桥接/nat配置问题，然后各种尝试，没卵用</li><li>然后尝试降低vm版本，降低版本后遇到vmnet/vmmon问题</li><li>更换manjaro内核，从6+版本内核降级到5.15,然后安装vm17,安装好以后加载vmnet/vmmon模块，然后启动虚拟网<code>sudo vmware-networks --start</code>，居然好了</li><li>为了确认6.0内核是否有问题，我又重启系统，选择6.4的内核，开机后挂载vmnet,发现又和之前一样了，一直挂载不了，基本可以确认vmware和6.0内核还不兼容</li></ol><p>总结：</p><ol><li>manjro必须使用6.0以下的内核</li><li>安装vm17后，必须手动加载模块 <code>sudo modprobe vmnet</code><code>sudo modprobe vmmon</code></li><li>启动虚拟网 <code>sudo vmware-networks --start</code></li></ol><div class="hint-container caution"><p class="hint-container-title">提示</p><p>以上方法作废，在比较新的linux内核上vmware支持的不够友好，在Manjaro官方是不支持vmware的，如果实在要安装vmware，不要用yay也不要用archlinuxcn中的，</p></div><h4 id="how-to-install-vmware" tabindex="-1"><a class="header-anchor" href="#how-to-install-vmware"><span>How to install VMware</span></a></h4><p>Enable CPU virtual extensions in your system’s firmware.</p><p>To install vmware on Manjaro you will have to resort to a PKGBUILD script.</p><p>There is a lot of AUR helpers and they all mimic what you should do manually - the Arch way is usually the best way.</p><h4 id="important-kernel-precaution" tabindex="-1"><a class="header-anchor" href="#important-kernel-precaution"><span>Important kernel precaution</span></a></h4><p>The AUR PKGBUILD is created for Archlinux and therefore the kernel headers dependency must be solved manually on Manjaro. Archlinux only have two kernel versions - linux and linux-lts.</p><p>Archlinux kernels follow the release schedule on kernel.org 23 and on Manjaro you will need to use the same kernel version.</p><p>19 June 2023 (Copenhagen)</p><ul><li>Linux 6.3.x (stable)</li><li>Linux 6.1.x (LTS)</li></ul><p>Using other kernels will most likely fail.</p><h4 id="building-steps" tabindex="-1"><a class="header-anchor" href="#building-steps"><span>Building steps</span></a></h4><ol><li>Update your system and Install the necessary build tools</li></ol><p><code>sudo pacman -Syu git base-devel --needed</code></p><ol start="2"><li>Then check your kernel version(s) - example - remember to use the same version as Arch</li></ol><p><code>$ mhwd-kernel -li</code></p><p>Currently running: 6.3.8-1-MANJARO (linux63) The following kernels are installed in your system:</p><ul><li>linux61</li><li>linux63</li></ul><ol start="3"><li><p>Then install the headers for your kernel(s) and dkms (use the kernels listed from your system) <code>sudo pacman -Syu $KERNELXYY-headers dkms</code></p></li><li><p>Clone the PKGBUILKD script <code>git clone https://aur.archlinux.org/vmware-workstation.git</code></p></li></ol><p>expect output like this</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>Cloning into <span class="token string">&#39;vmware-workstation&#39;</span><span class="token punctuation">..</span>.
remote: Enumerating objects: <span class="token number">498</span>, done.
remote: Counting objects: <span class="token number">100</span>% <span class="token punctuation">(</span><span class="token number">498</span>/498<span class="token punctuation">)</span>, done.
remote: Compressing objects: <span class="token number">100</span>% <span class="token punctuation">(</span><span class="token number">239</span>/239<span class="token punctuation">)</span>, done.
remote: Total <span class="token number">498</span> <span class="token punctuation">(</span>delta <span class="token number">307</span><span class="token punctuation">)</span>, reused <span class="token number">439</span> <span class="token punctuation">(</span>delta <span class="token number">258</span><span class="token punctuation">)</span>, pack-reused <span class="token number">0</span>
Receiving objects: <span class="token number">100</span>% <span class="token punctuation">(</span><span class="token number">498</span>/498<span class="token punctuation">)</span>, <span class="token number">256.62</span> KiB <span class="token operator">|</span> <span class="token number">3.21</span> MiB/s, done.
Resolving deltas: <span class="token number">100</span>% <span class="token punctuation">(</span><span class="token number">307</span>/307<span class="token punctuation">)</span>, done.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="5"><li><p>Familiarize yourself with the content - it is all text files and you should read them and verify what they are doing. <code>ls ~/vmware-workstation</code></p></li><li><p>When you are satisfied - cd into the folder and run makepkg to install dependencies, build and install the package.</p></li></ol><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> ~/vmware-workstation
makepkg <span class="token parameter variable">-is</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>The post install message reads</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token operator">==</span><span class="token operator">&gt;</span> Before using VMware, you need to <span class="token function">reboot</span> or load vmw_vmci and vmmon kernel modules <span class="token punctuation">(</span>in a terminal on root: modprobe <span class="token parameter variable">-a</span> vmw_vmci vmmon<span class="token punctuation">)</span>
<span class="token operator">==</span><span class="token operator">&gt;</span> You may also need to <span class="token builtin class-name">enable</span> some of the following services:
- vmware-networks: to have network access inside VMs
- vmware-usbarbitrator: to connect USB devices inside VMs
These services can be activated during boot by enabling .service <span class="token function">units</span> or only when a VM is started by enabling .path units.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Choose either of the options - not both</p><ul><li>To start and enable vmware network and usb service at boot</li></ul><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> <span class="token parameter variable">--now</span> vmware-networks.service
<span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> <span class="token parameter variable">--now</span> vmware-usbarbitrator.service
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>To start and enable vmware network and usb on demand</li></ul><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> <span class="token parameter variable">--now</span> vmware-networks.path
<span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> <span class="token parameter variable">--now</span> vmware-usbarbitrator.path
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>Either reboot your system or load the kernel modules by hand</p><p><code>sudo modprobe -a vmw_vmci vmmon</code> Because the resulting build is using dkms - you won’t have to rebuild the kernel modules on system update - dkms will take care of this.</p><p>参考： https://forum.manjaro.org/t/root-tip-how-to-installing-vmware-on-manjaro/57596</p><h3 id="_11、vnc" tabindex="-1"><a class="header-anchor" href="#_11、vnc"><span>11、vnc</span></a></h3><blockquote><p>在manjaro一直使用的realvnc,这是一个商业软件，使用体验一直不错，不过在某次升级后，无法破解所以放弃了它，后来转用tigervnc,记录以下tigervnc的使用</p></blockquote><ol><li>安装软件</li></ol><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment">##安装以后会自动包含客户端和服务端</span>
<span class="token function">sudo</span> pacman <span class="token parameter variable">-S</span> tigervnc
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>服务端设置密码</li></ol><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment">#根据提示输入</span>
vncpasswd 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>启动服务端</li></ol><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment">#启动一个服务，监听5901,以此类推vncserver :2 监听5902……</span>
vncserver :1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ol start="4"><li>客户端使用任何一个vnc客户端都可以连接，可以用realvnc,tigervnc，ultravnc等客户端都行，需要注意的是一定要开启键盘鼠标</li></ol><p><img src="https://afatpig.oss-cn-chengdu.aliyuncs.com/blog/20231013103250.png" alt="20231013103250"></p>`,110);function m(v,g){const s=i("ExternalLinkIcon");return o(),l("div",null,[p,a("p",null,[n("可以看到和"),a("a",d,[n("这个问题"),r(s)]),n("一模一样的套路。 3. 到 logrotate.service查看它实际上执行的是什么命令")]),u])}const k=t(c,[["render",m],["__file","Manjaro.html.vue"]]),f=JSON.parse('{"path":"/other/linux/Manjaro.html","title":"Manjaro问题搜集","lang":"zh-CN","frontmatter":{"title":"Manjaro问题搜集","date":"2022-03-22T00:00:00.000Z","author":"chenkun","publish":true,"keys":null,"description":"1、降级软件包 安装downgrade程序 sudo pacman -S downgrade 降级 sudo DOWNGRADE_FROM_ALA=1 downgrade xxx包 注意DOWNGRADE_FROM_ALA=1一定要按照我上边这样写，不能单独export DOWNGRADE_FROM_ALA=1 设置忽略升级的包 第二步会让你选择更新的...","head":[["meta",{"property":"og:url","content":"https://ChenSino.github.io/other/linux/Manjaro.html"}],["meta",{"property":"og:site_name","content":"ChenSino"}],["meta",{"property":"og:title","content":"Manjaro问题搜集"}],["meta",{"property":"og:description","content":"1、降级软件包 安装downgrade程序 sudo pacman -S downgrade 降级 sudo DOWNGRADE_FROM_ALA=1 downgrade xxx包 注意DOWNGRADE_FROM_ALA=1一定要按照我上边这样写，不能单独export DOWNGRADE_FROM_ALA=1 设置忽略升级的包 第二步会让你选择更新的..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://afatpig.oss-cn-chengdu.aliyuncs.com/blog/image-20220322171440300.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-03-22T03:45:12.000Z"}],["meta",{"property":"article:author","content":"chenkun"}],["meta",{"property":"article:published_time","content":"2022-03-22T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-03-22T03:45:12.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Manjaro问题搜集\\",\\"image\\":[\\"https://afatpig.oss-cn-chengdu.aliyuncs.com/blog/image-20220322171440300.png\\",\\"https://afatpig.oss-cn-chengdu.aliyuncs.com/blog/image-20220322171948840.png\\",\\"https://afatpig.oss-cn-chengdu.aliyuncs.com/blog/image-20220322172023905.png\\",\\"https://afatpig.oss-cn-chengdu.aliyuncs.com/blog/image-20220322172038617.png\\",\\"https://afatpig.oss-cn-chengdu.aliyuncs.com/blog/image-20220418155819498.png\\",\\"https://afatpig.oss-cn-chengdu.aliyuncs.com/blog/image-20220418155847045.png\\",\\"https://afatpig.oss-cn-chengdu.aliyuncs.com/blog/image-20220418155927678.png\\",\\"https://afatpig.oss-cn-chengdu.aliyuncs.com/blog/image-20220418155956979.png\\",\\"https://afatpig.oss-cn-chengdu.aliyuncs.com/blog/image-20220419110311199.png\\",\\"https://afatpig.oss-cn-chengdu.aliyuncs.com/blog/image-20220419110401735.png\\",\\"https://afatpig.oss-cn-chengdu.aliyuncs.com/blog/image-20220502211444881.png\\",\\"https://afatpig.oss-cn-chengdu.aliyuncs.com/blog/20231013103250.png\\"],\\"datePublished\\":\\"2022-03-22T00:00:00.000Z\\",\\"dateModified\\":\\"2024-03-22T03:45:12.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"chenkun\\"}]}"]]},"headers":[{"level":3,"title":"1、降级软件包","slug":"_1、降级软件包","link":"#_1、降级软件包","children":[]},{"level":3,"title":"2、开机报错failed to start rotate log files","slug":"_2、开机报错failed-to-start-rotate-log-files","link":"#_2、开机报错failed-to-start-rotate-log-files","children":[]},{"level":3,"title":"linux下输入法无法输入中文中括号问题","slug":"linux下输入法无法输入中文中括号问题","link":"#linux下输入法无法输入中文中括号问题","children":[]},{"level":3,"title":"3、美化","slug":"_3、美化","link":"#_3、美化","children":[]},{"level":3,"title":"4、设置yakuake提示没有权限修改文件","slug":"_4、设置yakuake提示没有权限修改文件","link":"#_4、设置yakuake提示没有权限修改文件","children":[]},{"level":3,"title":"4、Manjaro不支持Mysql","slug":"_4、manjaro不支持mysql","link":"#_4、manjaro不支持mysql","children":[]},{"level":3,"title":"5、Manjaro设置DNS","slug":"_5、manjaro设置dns","link":"#_5、manjaro设置dns","children":[]},{"level":3,"title":"6、Manjaro fcitx5中文大括号问题","slug":"_6、manjaro-fcitx5中文大括号问题","link":"#_6、manjaro-fcitx5中文大括号问题","children":[]},{"level":3,"title":"7、分支管理","slug":"_7、分支管理","link":"#_7、分支管理","children":[]},{"level":3,"title":"8、wine安装exe报错","slug":"_8、wine安装exe报错","link":"#_8、wine安装exe报错","children":[]},{"level":3,"title":"9、解压缩中文乱码","slug":"_9、解压缩中文乱码","link":"#_9、解压缩中文乱码","children":[]},{"level":3,"title":"10、vmware使用问题","slug":"_10、vmware使用问题","link":"#_10、vmware使用问题","children":[]},{"level":3,"title":"11、vnc","slug":"_11、vnc","link":"#_11、vnc","children":[]}],"git":{"createdTime":1659362219000,"updatedTime":1711079112000,"contributors":[{"name":"ChenSino","email":"462488588@qq.com","commits":5},{"name":"ChenSino","email":"chenxk@sonoscape.net","commits":2},{"name":"chenkun","email":"462488588@qq.com","commits":1},{"name":"chenxk","email":"chenxk@sonoscape.net","commits":1}]},"readingTime":{"minutes":10.45,"words":3136},"filePathRelative":"other/linux/Manjaro.md","localizedDate":"2022年3月22日","excerpt":"<h3>1、降级软件包</h3>\\n<p>安装downgrade程序\\n<code>sudo pacman -S downgrade</code>\\n降级\\n<code>sudo DOWNGRADE_FROM_ALA=1 downgrade xxx包</code>\\n注意DOWNGRADE_FROM_ALA=1一定要按照我上边这样写，不能单独export DOWNGRADE_FROM_ALA=1\\n设置忽略升级的包\\n第二步会让你选择更新的时候是否要忽略更新，选择y的话，它会在/etc/pacman.conf添加一个忽略，如果不想湖绿，把下面的IgnorePkg注释即可</p>\\n<p><img src=\\"https://afatpig.oss-cn-chengdu.aliyuncs.com/blog/image-20220322171440300.png\\" alt=\\"image-20220322171440300\\"></p>","autoDesc":true}');export{k as comp,f as data};
