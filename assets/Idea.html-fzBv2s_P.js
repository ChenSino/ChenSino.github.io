import{_ as n}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as i,o,c as s,a as e,b as a,d,e as l}from"./app-xHrnIhLr.js";const c={},p=e("h2",{id:"_1、多线程debug遇到的问题",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#_1、多线程debug遇到的问题"},[e("span",null,"1、多线程debug遇到的问题")])],-1),r={href:"https://www.jetbrains.com/help/idea/using-breakpoints.html#breakpoint-properties",target:"_blank",rel:"noopener noreferrer"},h=l(`<ul><li><p>All: all threads are suspended when any of the threads hits the breakpoint.</p></li><li><p>Thread: only the thread which hits the breakpoint is suspended.</p></li></ul><p><img src="https://afatpig.oss-cn-chengdu.aliyuncs.com/blog/20220729150247.png" alt="1"></p><p>今天用idea调试mybatis-plus多数据源切换时，遇到一个有趣的问题，我有两个线程，分别进入了两个方法，因为多数据源切换使用的ThreadLocal，我想调试为何数据源切换会失败的问题。在调试过程中，我在两个方法分别获取ThreadLocalMap，调试过程如下：</p><ol><li>我先执行了线程1，然后断点停留，查看第一个方法中<code>threadLocalMap</code>的结果，符合预期</li><li>然后执行线程2，查看第二个方法中<code>threadLocalMap</code>的结果，也符合预期</li><li>此时我又用Ctrl+鼠标左键去查看线程1中的<code>threadLocalMap</code>，发现变成和线程2中一样了 <img src="https://afatpig.oss-cn-chengdu.aliyuncs.com/blog/20220729145847.png" alt="2"></li></ol><p>经过第三步测试，我蒙蔽了，ThreadLocal不是线程之间不会互相干扰吗？怎么线程2修改了线程1的结果？<br> 这里说一下，debug中，Ctrl+鼠标左键点击字段确实能快捷查看字段值，但是其实它的本质还是查看当前线程的xxx字段，只要你没切换线程，直接用鼠标点到另一个线程中的字段，它其实只是用了你用快捷键点的那个字段名，实际还是差的当前线程的这个字段 <img src="https://afatpig.oss-cn-chengdu.aliyuncs.com/blog/20220729151140.png" alt="3"></p><p>如果想看另一个线程的同名字段，需要先切换线程<br><img src="https://afatpig.oss-cn-chengdu.aliyuncs.com/blog/20220729151320.png" alt="4"></p><p>另外如果你把两个线程中的字段名改成不一样，你会发现在线程2中用快捷键点线程1的字段，是取不到值的</p><h2 id="_2、idea指定jdk启动" tabindex="-1"><a class="header-anchor" href="#_2、idea指定jdk启动"><span>2、Idea指定jdk启动</span></a></h2><p>Idea升级后无法启动，查看日志报错明显的是jdk版本不兼容，需要用最新的jdk17，解决方法有多个。</p><blockquote><p>方法1：设置全局jdk为17,这个方法可以启动idea，但是不太好，毕竟其他软件可能不能使用最新的jdk</p></blockquote><blockquote><p>方法2：单独给idea配置jdk,我记得以前使用eclipse有个虚拟机参数<code>-vm</code>可以指定，但是在idea中并不好使， 所以就去看了一下idea的启动脚本idea.sh,看一下启动脚本，就知idea启动时到底使用的是那个jdk，根据idea读取 的配置文件去配置就好了，可以设置JRE环境变量、可以指定JDK_HOME环境变量，我这里使用的是配置文件的方式，配置 idea.jdk</p></blockquote><p><img src="https://afatpig.oss-cn-chengdu.aliyuncs.com/blog/20221202112129.png" alt="20221202112129"></p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code> <span class="token function">cat</span> ~/.config/JetBrains/IntelliJIdea2022.3/idea.jdk                                      
/usr/lib/jvm/java-17-openjdk
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3、idea中git操作" tabindex="-1"><a class="header-anchor" href="#_3、idea中git操作"><span>3、idea中git操作</span></a></h2><h3 id="_3-1-对比任意非连续的两次提交文件差异" tabindex="-1"><a class="header-anchor" href="#_3-1-对比任意非连续的两次提交文件差异"><span>3.1 对比任意非连续的两次提交文件差异</span></a></h3><p>选中两次提交，右键Compare Versions，</p><p><img src="http://afatpig.oss-cn-chengdu.aliyuncs.com/blog/image-20221229215718576.png" alt="image-20221229215718576"></p><p>会出现一个change log的视图，这就是两次提价的差异文件</p><p><img src="http://afatpig.oss-cn-chengdu.aliyuncs.com/blog/image-20221229215820791.png" alt="image-20221229215820791"></p><h2 id="_4、debug无法进入jdk源码" tabindex="-1"><a class="header-anchor" href="#_4、debug无法进入jdk源码"><span>4、debug无法进入jdk源码</span></a></h2><p>idea2022版本默认，调试时跳过底层源码，具体参考下图，把需要加入debug的源码去掉勾选 <img src="https://afatpig.oss-cn-chengdu.aliyuncs.com/blog/20230201173830.png" alt="20230201173830"></p>`,21);function g(u,m){const t=i("ExternalLinkIcon");return o(),s("div",null,[p,e("p",null,[a("多线程调试需要把Thread选上，至于Thread和All的区别请查看"),e("a",r,[a("官方文档"),d(t)])]),h])}const _=n(c,[["render",g],["__file","Idea.html.vue"]]),f=JSON.parse('{"path":"/other/tools/Idea.html","title":"Idea","lang":"zh-CN","frontmatter":{"title":"Idea","date":"2022-07-29T00:00:00.000Z","author":"chenkun","publish":true,"keys":null,"description":"1、多线程debug遇到的问题 多线程调试需要把Thread选上，至于Thread和All的区别请查看官方文档 All: all threads are suspended when any of the threads hits the breakpoint. Thread: only the thread which hits the breakp...","head":[["meta",{"property":"og:url","content":"https://ChenSino.github.io/other/tools/Idea.html"}],["meta",{"property":"og:site_name","content":"ChenSino"}],["meta",{"property":"og:title","content":"Idea"}],["meta",{"property":"og:description","content":"1、多线程debug遇到的问题 多线程调试需要把Thread选上，至于Thread和All的区别请查看官方文档 All: all threads are suspended when any of the threads hits the breakpoint. Thread: only the thread which hits the breakp..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://afatpig.oss-cn-chengdu.aliyuncs.com/blog/20220729150247.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-03-22T03:45:12.000Z"}],["meta",{"property":"article:author","content":"chenkun"}],["meta",{"property":"article:published_time","content":"2022-07-29T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-03-22T03:45:12.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Idea\\",\\"image\\":[\\"https://afatpig.oss-cn-chengdu.aliyuncs.com/blog/20220729150247.png\\",\\"https://afatpig.oss-cn-chengdu.aliyuncs.com/blog/20220729145847.png\\",\\"https://afatpig.oss-cn-chengdu.aliyuncs.com/blog/20220729151140.png\\",\\"https://afatpig.oss-cn-chengdu.aliyuncs.com/blog/20220729151320.png\\",\\"https://afatpig.oss-cn-chengdu.aliyuncs.com/blog/20221202112129.png\\",\\"http://afatpig.oss-cn-chengdu.aliyuncs.com/blog/image-20221229215718576.png\\",\\"http://afatpig.oss-cn-chengdu.aliyuncs.com/blog/image-20221229215820791.png\\",\\"https://afatpig.oss-cn-chengdu.aliyuncs.com/blog/20230201173830.png\\"],\\"datePublished\\":\\"2022-07-29T00:00:00.000Z\\",\\"dateModified\\":\\"2024-03-22T03:45:12.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"chenkun\\"}]}"]]},"headers":[{"level":2,"title":"1、多线程debug遇到的问题","slug":"_1、多线程debug遇到的问题","link":"#_1、多线程debug遇到的问题","children":[]},{"level":2,"title":"2、Idea指定jdk启动","slug":"_2、idea指定jdk启动","link":"#_2、idea指定jdk启动","children":[]},{"level":2,"title":"3、idea中git操作","slug":"_3、idea中git操作","link":"#_3、idea中git操作","children":[{"level":3,"title":"3.1 对比任意非连续的两次提交文件差异","slug":"_3-1-对比任意非连续的两次提交文件差异","link":"#_3-1-对比任意非连续的两次提交文件差异","children":[]}]},{"level":2,"title":"4、debug无法进入jdk源码","slug":"_4、debug无法进入jdk源码","link":"#_4、debug无法进入jdk源码","children":[]}],"git":{"createdTime":1669951441000,"updatedTime":1711079112000,"contributors":[{"name":"ChenSino","email":"chenxk@sonoscape.net","commits":2},{"name":"ChenSino","email":"462488588@qq.com","commits":1},{"name":"chenkun","email":"462488588@qq.com","commits":1}]},"readingTime":{"minutes":2.74,"words":823},"filePathRelative":"other/tools/Idea.md","localizedDate":"2022年7月29日","excerpt":"<h2>1、多线程debug遇到的问题</h2>\\n<p>多线程调试需要把Thread选上，至于Thread和All的区别请查看<a href=\\"https://www.jetbrains.com/help/idea/using-breakpoints.html#breakpoint-properties\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">官方文档</a></p>\\n<ul>\\n<li>\\n<p>All: all threads are suspended when any of the threads hits the breakpoint.</p>\\n</li>\\n<li>\\n<p>Thread: only the thread which hits the breakpoint is suspended.</p>\\n</li>\\n</ul>","autoDesc":true}');export{_ as comp,f as data};
